{"ast":null,"code":"import axios from\"axios\";import{useContext,useEffect,useState}from\"react\";import{useLocation}from\"react-router\";import{Link}from\"react-router-dom\";import{Context}from\"../../context/Context\";import\"./singlePost.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){const location=useLocation();const path=location.pathname.split(\"/\")[2];const[post,setPost]=useState({});const PF=\"http://localhost:5000/images/\";const{user}=useContext(Context);const[title,setTitle]=useState(\"\");const[desc,setDesc]=useState(\"\");const[updateMode,setUpdateMode]=useState(false);useEffect(()=>{const getPost=async()=>{const res=await axios.get(\"/posts/\"+path);setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);};getPost();},[path]);const handleDelete=async()=>{try{await axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});window.location.replace(\"/\");}catch(err){}};const handleUpdate=async()=>{try{await axios.put(\"/posts/\".concat(post._id),{username:user.username,title,desc});setUpdateMode(false);}catch(err){}};return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:e=>setTitle(e.target.value)}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:()=>setUpdateMode(true)}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsxs(\"b\",{children:[\" \",post.username]})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:e=>setDesc(e.target.value)}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"names":["axios","useContext","useEffect","useState","useLocation","Link","Context","jsx","_jsx","jsxs","_jsxs","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","res","get","data","handleDelete","delete","concat","_id","username","window","replace","err","handleUpdate","put","className","children","photo","src","alt","type","value","autoFocus","onChange","e","target","onClick","to","Date","createdAt","toDateString"],"sources":["C:/Users/ASUS/OneDrive/Desktop/react-blog/client/src/components/singlePost/SinglePost.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { useLocation } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Context } from \"../../context/Context\";\r\nimport \"./singlePost.css\";\r\n\r\nexport default function SinglePost() {\r\n  const location = useLocation();\r\n  const path = location.pathname.split(\"/\")[2];\r\n  const [post, setPost] = useState({});\r\n  const PF = \"http://localhost:5000/images/\";\r\n  const { user } = useContext(Context);\r\n  const [title, setTitle] = useState(\"\");\r\n  const [desc, setDesc] = useState(\"\");\r\n  const [updateMode, setUpdateMode] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const getPost = async () => {\r\n      const res = await axios.get(\"/posts/\" + path);\r\n      setPost(res.data);\r\n      setTitle(res.data.title);\r\n      setDesc(res.data.desc);\r\n    };\r\n    getPost();\r\n  }, [path]);\r\n\r\n  const handleDelete = async () => {\r\n    try {\r\n      await axios.delete(`/posts/${post._id}`, {\r\n        data: { username: user.username },\r\n      });\r\n      window.location.replace(\"/\");\r\n    } catch (err) {}\r\n  };\r\n\r\n  const handleUpdate = async () => {\r\n    try {\r\n      await axios.put(`/posts/${post._id}`, {\r\n        username: user.username,\r\n        title,\r\n        desc,\r\n      });\r\n      setUpdateMode(false)\r\n    } catch (err) {}\r\n  };\r\n\r\n  return (\r\n    <div className=\"singlePost\">\r\n      <div className=\"singlePostWrapper\">\r\n        {post.photo && (\r\n          <img src={PF + post.photo} alt=\"\" className=\"singlePostImg\" />\r\n        )}\r\n        {updateMode ? (\r\n          <input\r\n            type=\"text\"\r\n            value={title}\r\n            className=\"singlePostTitleInput\"\r\n            autoFocus\r\n            onChange={(e) => setTitle(e.target.value)}\r\n          />\r\n        ) : (\r\n          <h1 className=\"singlePostTitle\">\r\n            {title}\r\n            {post.username === user?.username && (\r\n              <div className=\"singlePostEdit\">\r\n                <i\r\n                  className=\"singlePostIcon far fa-edit\"\r\n                  onClick={() => setUpdateMode(true)}\r\n                ></i>\r\n                <i\r\n                  className=\"singlePostIcon far fa-trash-alt\"\r\n                  onClick={handleDelete}\r\n                ></i>\r\n              </div>\r\n            )}\r\n          </h1>\r\n        )}\r\n        <div className=\"singlePostInfo\">\r\n          <span className=\"singlePostAuthor\">\r\n            Author:\r\n            <Link to={`/?user=${post.username}`} className=\"link\">\r\n              <b> {post.username}</b>\r\n            </Link>\r\n          </span>\r\n          <span className=\"singlePostDate\">\r\n            {new Date(post.createdAt).toDateString()}\r\n          </span>\r\n        </div>\r\n        {updateMode ? (\r\n          <textarea\r\n            className=\"singlePostDescInput\"\r\n            value={desc}\r\n            onChange={(e) => setDesc(e.target.value)}\r\n          />\r\n        ) : (\r\n          <p className=\"singlePostDesc\">{desc}</p>\r\n        )}\r\n        {updateMode && (\r\n          <button className=\"singlePostButton\" onClick={handleUpdate}>\r\n            Update\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}